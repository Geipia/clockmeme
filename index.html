<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Horloge Ultimate</title>

<style>
body{
margin:0;
height:100vh;
display:flex;
justify-content:center;
align-items:center;
flex-direction:column;
background:#050505;
font-family:system-ui;
background-size:cover;
background-position:center;
color:white;
}

#clock{
font-size:100px;
color:#00ffff;
text-shadow:0 0 25px #00ffff;
}

#weather{
margin-top:10px;
font-size:18px;
opacity:.8;
}

#toggle{
position:fixed;
bottom:20px;
right:20px;
width:55px;
height:55px;
border-radius:50%;
border:none;
background:#00ffff;
font-size:22px;
cursor:pointer;
box-shadow:0 0 20px #00ffff;
}

#settings{
position:fixed;
bottom:85px;
right:20px;
width:230px;
background:rgba(255,255,255,.12);
backdrop-filter:blur(15px);
padding:15px;
border-radius:15px;
display:none;
box-shadow:0 0 25px rgba(0,0,0,.6);
animation:pop .2s;
}

@keyframes pop{
from{transform:scale(.8);opacity:0}
to{transform:scale(1);opacity:1}
}

label{font-size:13px;margin-top:8px;display:block}
input,select{width:100%;margin-top:4px}
</style>
</head>

<body>

<div id="clock">00:00:00</div>
<div id="weather">üåç m√©t√©o...</div>

<div id="settings">

<label>Couleur heure</label>
<input id="cColor" type="color">

<label>Glow</label>
<input id="cGlow" type="range" min="0" max="60">

<label>Taille</label>
<input id="cSize" type="range" min="40" max="160">

<label>Police heure</label>
<select id="cFont">
<option>Arial</option>
<option>Georgia</option>
<option>Verdana</option>
<option>Courier New</option>
<option>Impact</option>
</select>

<label>Fond image</label>
<input type="file" accept="image/*" onchange="bgImage(this)">

<label>Fond couleur</label>
<input id="bgColor" type="color">

<label>Volume</label>
<input id="cVolume" type="range" min="0" max="1" step="0.01">

<label>Musique MP3</label>
<input type="file" accept="audio/mp3" onchange="playMusic(this)">

</div>

<button id="toggle" onclick="toggle()">‚öôÔ∏è</button>

<audio id="music"></audio>

<script>
const clock=document.getElementById("clock");
const music=document.getElementById("music");
const weather=document.getElementById("weather");

let color="#00ffff", volume=.5;

// ===== Horloge =====
setInterval(()=>clock.innerHTML=new Date().toLocaleTimeString(),1000);

// ===== Menu =====
function toggle(){
settings.style.display=settings.style.display=="block"?"none":"block";
}

// ===== Audio fondu =====
function playMusic(i){
music.src=URL.createObjectURL(i.files[0]);
music.volume=0;
music.play();
fadeIn();
}

music.onended=()=>{
fadeOut(()=>{
music.currentTime=0;
music.play();
fadeIn();
});
};

function fadeIn(){
let v=0;
let t=setInterval(()=>{
v+=.02;
music.volume=Math.min(v,volume);
if(v>=volume)clearInterval(t);
},50);
}

function fadeOut(cb){
let v=music.volume;
let t=setInterval(()=>{
v-=.02;
music.volume=Math.max(v,0);
if(v<=0){clearInterval(t);cb();}
},50);
}

// ===== Fond =====
function bgImage(i){
document.body.style.backgroundImage=
"url("+URL.createObjectURL(i.files[0])+")";
}

// ===== R√©glages + sauvegarde =====
function save(){
localStorage.setItem("cfg",JSON.stringify({
color:color,
glow:cGlow.value,
size:cSize.value,
font:cFont.value,
bg:bgColor.value,
volume:cVolume.value
}));
}

function load(){
let c=JSON.parse(localStorage.getItem("cfg")||"{}");
if(!c.color)return;

color=c.color;
clock.style.color=c.color;
clock.style.textShadow="0 0 "+c.glow+"px "+c.color;
clock.style.fontSize=c.size+"px";
clock.style.fontFamily=c.font;
document.body.style.background=c.bg;
music.volume=c.volume;

cColor.value=c.color;
cGlow.value=c.glow;
cSize.value=c.size;
cFont.value=c.font;
bgColor.value=c.bg;
cVolume.value=c.volume;
volume=c.volume;
}

cColor.oninput=e=>{color=e.target.value;clock.style.color=color;save();}
cGlow.oninput=e=>{clock.style.textShadow="0 0 "+e.target.value+"px "+color;save();}
cSize.oninput=e=>{clock.style.fontSize=e.target.value+"px";save();}
cFont.onchange=e=>{clock.style.fontFamily=e.target.value;save();}
bgColor.oninput=e=>{document.body.style.background=e.target.value;save();}
cVolume.oninput=e=>{volume=e.target.value;music.volume=volume;save();}

load();

// ===== M√©t√©o =====
navigator.geolocation.getCurrentPosition(p=>{
fetch(`https://api.open-meteo.com/v1/forecast?latitude=${p.coords.latitude}&longitude=${p.coords.longitude}&current_weather=true`)
.then(r=>r.json())
.then(d=>{
weather.innerHTML="üå° "+d.current_weather.temperature+"¬∞C  üí® "+d.current_weather.windspeed+"km/h";
});
});
</script>

</body>
</html>
